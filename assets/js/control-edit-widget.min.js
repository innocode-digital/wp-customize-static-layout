!function(t,c,i){"use strict";var d=t.customize;d.controlConstructor[i.type]=d.Control.extend({getBaseId:function(){return this.setting.id.replace(/([^[]+\[\d+]\[[^\[]+])\[\d+]$/g,"$1")},getIndexById:function(t){return parseInt(t.replace(/[^[]+\[\d+]\[[^\[]+]\[(\d+)]$/g,"$1"),10)},getIndex:function(){return this.getIndexById(this.setting.id)},getNameById:function(t){return t.replace(/[^[]+\[\d+]\[[^\[]+]\[\d+]\[(\w+)]$/g,"$1")},removeWidget:function(){var t=d.section(this.setting.id),e=this.getBaseId(),i=this.getIndex(),n=d.section(this.section()),o=[],s=c.filter(n.controls(),function(t){return 0===t.id.lastIndexOf(e+"[",0)}),n=c.last(s);return t.collapse(),c.forEach(c.filter(s,function(t){t=this.getIndexById(t.id);return!isNaN(t)&&i<t&&(o.push(t),!0)}.bind(this)),function(t,i){t=d.section(t.id);c.forEach(t.controls(),function(t){d(e+"["+(o[i]-1)+"]["+this.getNameById(t.id)+"]").set(d(t.id).get())}.bind(this))}.bind(this)),c.forEach(d.section(n.id).controls(),function(t){d.remove(t.id),d.control(t.id).container.remove(),d.control.remove(t.id)}),d.remove(n.id),d.control(n.id).container.remove(),d.control.remove(n.id),d.section(n.id).container.remove(),d.section.remove(n.id),this.removeFromBase(e),this},removeFromBase:function(t,i){var e=d(t),n=e.get(),o=c.clone(n);return o.pop(),e.set(o),e.callbacks.fireWith(e,[o,n]),--d.control(t).index,n[i]},deactivateAllButtons:function(){return this.container.siblings("."+this.container[0].className.split(/\s+/).join(".")).find("."+i.namespace+"-edit-widget-button").removeClass("active"),this},maybeToggleDuplication:function(){return this.container.find("."+i.namespace+"-duplicate-widget-button").prop("disabled",c.isEmpty(c.filter(d(this.getBaseId()).get()[this.getIndex()]))),this},_onClick:function(t){return t.preventDefault(),d.section(this.setting.id).expand(),this},_onDuplicateClick:function(t){t.preventDefault();var t=this.getBaseId(),i=d.control(t).addWidget();return c.forEach(d.section(this.setting.id).controls(),function(t){d(i+"["+this.getNameById(t.id)+"]").set(d(t.id).get())}.bind(this)),d.section(i).expand(),this},_onRemoveClick:function(t){return t.preventDefault(),confirm(this.params.l10n.confirmRemove)&&(this.deactivateAllButtons(),this.removeWidget()),this},_onExpanded:function(){return this.container.find("."+i.namespace+"-edit-widget-button").addClass("active"),this.deactivateAllButtons(),this},_onCollapsed:function(){return this.container.find("."+i.namespace+"-edit-widget-button").removeClass("active"),this},ready:function(){var t=d.section(this.setting.id);return this.container.find("."+i.namespace+"-edit-widget-button").on("click",this._onClick.bind(this)),this.container.find("."+i.namespace+"-duplicate-widget-button").on("click",this._onDuplicateClick.bind(this)),this.container.find("."+i.namespace+"-remove-widget-button").on("click",this._onRemoveClick.bind(this)),t&&((t=d.section(this.setting.id).container).on("expanded",this._onExpanded.bind(this)),t.on("collapsed",this._onCollapsed.bind(this)),this.maybeToggleDuplication(),c.forEach(d.section(this.setting.id).controls(),function(t){d(t.id).bind(this.maybeToggleDuplication.bind(this))}.bind(this))),this}})}((jQuery,window.wp),_,window.customizeStaticLayoutControlEditWidget);